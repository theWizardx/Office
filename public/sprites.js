// ============================================================
// 8-Bit Pixel Art Sprite System for Claude Code Office Visualizer
// ============================================================
// All sprites are 2D arrays of hex color strings (null = transparent)
// Designed in classic NES / GameBoy pixel art style
// ============================================================

const _ = null; // shorthand for transparent pixel

const SPRITES = {

  // ----------------------------------------------------------
  // CLAUDE_IDLE  (16x16) – cute robot sitting idle
  // ----------------------------------------------------------
  CLAUDE_IDLE: [
    //0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15
    [ _,    _,    _,    _,    _,    _,    _,'#FF6B00', _,   _,    _,    _,    _,    _,    _,    _ ],  // 0  antenna tip
    [ _,    _,    _,    _,    _,    _,    _,'#FF6B00', _,   _,    _,    _,    _,    _,    _,    _ ],  // 1  antenna stem
    [ _,    _,    _,    _,    _,    _,'#FF9E44','#FF6B00','#FF9E44', _,   _,    _,    _,    _,    _,    _ ],  // 2  antenna base
    [ _,    _,    _,    _,'#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A', _,   _,    _,    _,    _ ],  // 3  head top
    [ _,    _,    _,'#4A4A4A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#4A4A4A', _,   _,    _,    _ ],  // 4  head
    [ _,    _,    _,'#4A4A4A','#5A5A5A','#FF6B00','#FF9E44','#5A5A5A','#FF6B00','#FF9E44','#5A5A5A','#4A4A4A', _,   _,    _,    _ ],  // 5  eyes row
    [ _,    _,    _,'#4A4A4A','#5A5A5A','#FF9E44','#FFFFFF','#5A5A5A','#FF9E44','#FFFFFF','#5A5A5A','#4A4A4A', _,   _,    _,    _ ],  // 6  eye highlights
    [ _,    _,    _,'#4A4A4A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#4A4A4A', _,   _,    _,    _ ],  // 7  below eyes
    [ _,    _,    _,    _,'#4A4A4A','#4A4A4A','#FF9E44','#FF9E44','#FF9E44','#4A4A4A','#4A4A4A', _,   _,    _,    _,    _ ],  // 8  mouth / chin
    [ _,    _,    _,    _,    _,'#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D', _,   _,    _,    _,    _,    _ ],  // 9  neck
    [ _,    _,    _,    _,'#2D2D2D','#2D2D2D','#3A3A3A','#3A3A3A','#3A3A3A','#2D2D2D','#2D2D2D', _,   _,    _,    _,    _ ],  // 10 body top
    [ _,    _,    _,'#2D2D2D','#2D2D2D','#3A3A3A','#FF6B00','#FF6B00','#FF6B00','#3A3A3A','#2D2D2D','#2D2D2D', _,   _,    _,    _ ],  // 11 body with orange badge
    [ _,    _,'#4A4A4A','#2D2D2D','#2D2D2D','#3A3A3A','#3A3A3A','#3A3A3A','#3A3A3A','#3A3A3A','#2D2D2D','#2D2D2D','#4A4A4A', _,   _,    _ ],  // 12 body + arms resting
    [ _,    _,    _,'#4A4A4A','#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D','#4A4A4A', _,   _,    _,    _ ],  // 13 lap
    [ _,    _,    _,    _,'#4A4A4A','#4A4A4A','#2D2D2D','#2D2D2D','#2D2D2D','#4A4A4A','#4A4A4A', _,   _,    _,    _,    _ ],  // 14 legs
    [ _,    _,    _,    _,'#4A4A4A','#4A4A4A', _,    _,    _,'#4A4A4A','#4A4A4A', _,   _,    _,    _,    _ ],  // 15 feet
  ],

  // ----------------------------------------------------------
  // CLAUDE_WORKING  (16x16, 3 frames) – typing animation
  // ----------------------------------------------------------
  CLAUDE_WORKING: [
    // Frame 0: hands left
    [
      [ _,    _,    _,    _,    _,    _,    _,'#FF6B00', _,   _,    _,    _,    _,    _,    _,    _ ],
      [ _,    _,    _,    _,    _,    _,    _,'#FF6B00', _,   _,    _,    _,    _,    _,    _,    _ ],
      [ _,    _,    _,    _,    _,    _,'#FF9E44','#FF6B00','#FF9E44', _,   _,    _,    _,    _,    _,    _ ],
      [ _,    _,    _,    _,'#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A', _,   _,    _,    _,    _ ],
      [ _,    _,    _,'#4A4A4A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#4A4A4A', _,   _,    _,    _ ],
      [ _,    _,    _,'#4A4A4A','#5A5A5A','#FF6B00','#FF9E44','#5A5A5A','#FF6B00','#FF9E44','#5A5A5A','#4A4A4A', _,   _,    _,    _ ],
      [ _,    _,    _,'#4A4A4A','#5A5A5A','#FF9E44','#FFFFFF','#5A5A5A','#FF9E44','#FFFFFF','#5A5A5A','#4A4A4A', _,   _,    _,    _ ],
      [ _,    _,    _,'#4A4A4A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#4A4A4A', _,   _,    _,    _ ],
      [ _,    _,    _,    _,'#4A4A4A','#4A4A4A','#FF9E44','#FF9E44','#FF9E44','#4A4A4A','#4A4A4A', _,   _,    _,    _,    _ ],
      [ _,    _,    _,    _,    _,'#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D', _,   _,    _,    _,    _,    _ ],
      [ _,    _,    _,    _,'#2D2D2D','#2D2D2D','#3A3A3A','#3A3A3A','#3A3A3A','#2D2D2D','#2D2D2D', _,   _,    _,    _,    _ ],
      [ _,    _,    _,'#2D2D2D','#2D2D2D','#3A3A3A','#FF6B00','#FF6B00','#FF6B00','#3A3A3A','#2D2D2D','#2D2D2D', _,   _,    _,    _ ],
      ['#4A4A4A','#4A4A4A','#4A4A4A','#2D2D2D','#2D2D2D','#3A3A3A','#3A3A3A','#3A3A3A','#3A3A3A','#3A3A3A','#2D2D2D','#2D2D2D', _,   _,    _,    _ ],
      [ _,    _,    _,'#4A4A4A','#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D','#4A4A4A', _,   _,    _,    _ ],
      [ _,    _,    _,    _,'#4A4A4A','#4A4A4A','#2D2D2D','#2D2D2D','#2D2D2D','#4A4A4A','#4A4A4A', _,   _,    _,    _,    _ ],
      [ _,    _,    _,    _,'#4A4A4A','#4A4A4A', _,    _,    _,'#4A4A4A','#4A4A4A', _,   _,    _,    _,    _ ],
    ],
    // Frame 1: hands center
    [
      [ _,    _,    _,    _,    _,    _,    _,'#FF6B00', _,   _,    _,    _,    _,    _,    _,    _ ],
      [ _,    _,    _,    _,    _,    _,    _,'#FF6B00', _,   _,    _,    _,    _,    _,    _,    _ ],
      [ _,    _,    _,    _,    _,    _,'#FF9E44','#FF6B00','#FF9E44', _,   _,    _,    _,    _,    _,    _ ],
      [ _,    _,    _,    _,'#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A', _,   _,    _,    _,    _ ],
      [ _,    _,    _,'#4A4A4A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#4A4A4A', _,   _,    _,    _ ],
      [ _,    _,    _,'#4A4A4A','#5A5A5A','#FF6B00','#FF9E44','#5A5A5A','#FF6B00','#FF9E44','#5A5A5A','#4A4A4A', _,   _,    _,    _ ],
      [ _,    _,    _,'#4A4A4A','#5A5A5A','#FF9E44','#FFFFFF','#5A5A5A','#FF9E44','#FFFFFF','#5A5A5A','#4A4A4A', _,   _,    _,    _ ],
      [ _,    _,    _,'#4A4A4A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#4A4A4A', _,   _,    _,    _ ],
      [ _,    _,    _,    _,'#4A4A4A','#4A4A4A','#FF9E44','#FF9E44','#FF9E44','#4A4A4A','#4A4A4A', _,   _,    _,    _,    _ ],
      [ _,    _,    _,    _,    _,'#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D', _,   _,    _,    _,    _,    _ ],
      [ _,    _,    _,    _,'#2D2D2D','#2D2D2D','#3A3A3A','#3A3A3A','#3A3A3A','#2D2D2D','#2D2D2D', _,   _,    _,    _,    _ ],
      [ _,    _,    _,'#2D2D2D','#2D2D2D','#3A3A3A','#FF6B00','#FF6B00','#FF6B00','#3A3A3A','#2D2D2D','#2D2D2D', _,   _,    _,    _ ],
      [ _,    _,'#4A4A4A','#2D2D2D','#4A4A4A','#3A3A3A','#3A3A3A','#3A3A3A','#3A3A3A','#3A3A3A','#4A4A4A','#2D2D2D','#4A4A4A', _,   _,    _ ],
      [ _,    _,    _,'#4A4A4A','#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D','#4A4A4A', _,   _,    _,    _ ],
      [ _,    _,    _,    _,'#4A4A4A','#4A4A4A','#2D2D2D','#2D2D2D','#2D2D2D','#4A4A4A','#4A4A4A', _,   _,    _,    _,    _ ],
      [ _,    _,    _,    _,'#4A4A4A','#4A4A4A', _,    _,    _,'#4A4A4A','#4A4A4A', _,   _,    _,    _,    _ ],
    ],
    // Frame 2: hands right
    [
      [ _,    _,    _,    _,    _,    _,    _,'#FF6B00', _,   _,    _,    _,    _,    _,    _,    _ ],
      [ _,    _,    _,    _,    _,    _,    _,'#FF6B00', _,   _,    _,    _,    _,    _,    _,    _ ],
      [ _,    _,    _,    _,    _,    _,'#FF9E44','#FF6B00','#FF9E44', _,   _,    _,    _,    _,    _,    _ ],
      [ _,    _,    _,    _,'#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A', _,   _,    _,    _,    _ ],
      [ _,    _,    _,'#4A4A4A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#4A4A4A', _,   _,    _,    _ ],
      [ _,    _,    _,'#4A4A4A','#5A5A5A','#FF6B00','#FF9E44','#5A5A5A','#FF6B00','#FF9E44','#5A5A5A','#4A4A4A', _,   _,    _,    _ ],
      [ _,    _,    _,'#4A4A4A','#5A5A5A','#FF9E44','#FFFFFF','#5A5A5A','#FF9E44','#FFFFFF','#5A5A5A','#4A4A4A', _,   _,    _,    _ ],
      [ _,    _,    _,'#4A4A4A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#4A4A4A', _,   _,    _,    _ ],
      [ _,    _,    _,    _,'#4A4A4A','#4A4A4A','#FF9E44','#FF9E44','#FF9E44','#4A4A4A','#4A4A4A', _,   _,    _,    _,    _ ],
      [ _,    _,    _,    _,    _,'#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D', _,   _,    _,    _,    _,    _ ],
      [ _,    _,    _,    _,'#2D2D2D','#2D2D2D','#3A3A3A','#3A3A3A','#3A3A3A','#2D2D2D','#2D2D2D', _,   _,    _,    _,    _ ],
      [ _,    _,    _,'#2D2D2D','#2D2D2D','#3A3A3A','#FF6B00','#FF6B00','#FF6B00','#3A3A3A','#2D2D2D','#2D2D2D', _,   _,    _,    _ ],
      [ _,    _,    _,'#2D2D2D','#2D2D2D','#3A3A3A','#3A3A3A','#3A3A3A','#3A3A3A','#3A3A3A','#2D2D2D','#2D2D2D','#4A4A4A','#4A4A4A','#4A4A4A', _ ],
      [ _,    _,    _,'#4A4A4A','#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D','#4A4A4A', _,   _,    _,    _ ],
      [ _,    _,    _,    _,'#4A4A4A','#4A4A4A','#2D2D2D','#2D2D2D','#2D2D2D','#4A4A4A','#4A4A4A', _,   _,    _,    _,    _ ],
      [ _,    _,    _,    _,'#4A4A4A','#4A4A4A', _,    _,    _,'#4A4A4A','#4A4A4A', _,   _,    _,    _,    _ ],
    ],
  ],

  // ----------------------------------------------------------
  // GEMINI_IDLE  (16x16) – sleek cyan robot
  // ----------------------------------------------------------
  GEMINI_IDLE: [
    [ _,    _,    _,    _,    _,    _,    _,'#06B6D4', _,   _,    _,    _,    _,    _,    _,    _ ],
    [ _,    _,    _,    _,    _,    _,    _,'#22D3EE', _,   _,    _,    _,    _,    _,    _,    _ ],
    [ _,    _,    _,    _,    _,    _,'#06B6D4','#22D3EE','#06B6D4', _,   _,    _,    _,    _,    _,    _ ],
    [ _,    _,    _,    _,    _,'#1E293B','#1E293B','#1E293B','#1E293B','#1E293B', _,   _,    _,    _,    _,    _ ],
    [ _,    _,    _,    _,'#1E293B','#334155','#334155','#334155','#334155','#334155','#1E293B', _,   _,    _,    _,    _ ],
    [ _,    _,    _,'#1E293B','#334155','#06B6D4','#22D3EE','#334155','#06B6D4','#22D3EE','#334155','#1E293B', _,   _,    _,    _ ],
    [ _,    _,    _,'#1E293B','#334155','#22D3EE','#FFFFFF','#334155','#22D3EE','#FFFFFF','#334155','#1E293B', _,   _,    _,    _ ],
    [ _,    _,    _,'#1E293B','#334155','#334155','#334155','#334155','#334155','#334155','#334155','#1E293B', _,   _,    _,    _ ],
    [ _,    _,    _,    _,'#1E293B','#1E293B','#22D3EE','#22D3EE','#22D3EE','#1E293B','#1E293B', _,   _,    _,    _,    _ ],
    [ _,    _,    _,    _,    _,'#0F172A','#0F172A','#0F172A','#0F172A','#0F172A', _,   _,    _,    _,    _,    _ ],
    [ _,    _,    _,    _,'#0F172A','#0F172A','#1E293B','#1E293B','#1E293B','#0F172A','#0F172A', _,   _,    _,    _,    _ ],
    [ _,    _,    _,'#0F172A','#0F172A','#1E293B','#06B6D4','#06B6D4','#06B6D4','#1E293B','#0F172A','#0F172A', _,   _,    _,    _ ],
    [ _,    _,'#334155','#0F172A','#0F172A','#1E293B','#1E293B','#1E293B','#1E293B','#1E293B','#0F172A','#0F172A','#334155', _,   _,    _ ],
    [ _,    _,    _,'#334155','#0F172A','#0F172A','#0F172A','#0F172A','#0F172A','#0F172A','#0F172A','#334155', _,   _,    _,    _ ],
    [ _,    _,    _,    _,'#334155','#334155','#0F172A','#0F172A','#0F172A','#334155','#334155', _,   _,    _,    _,    _ ],
    [ _,    _,    _,    _,'#334155','#334155', _,    _,    _,'#334155','#334155', _,   _,    _,    _,    _ ],
  ],

  // ----------------------------------------------------------
  // GEMINI_WORKING  (16x16, 3 frames)
  // ----------------------------------------------------------
  GEMINI_WORKING: [
    // Frame 0
    [
      [ _,    _,    _,    _,    _,    _,    _,'#06B6D4', _,   _,    _,    _,    _,    _,    _,    _ ],
      [ _,    _,    _,    _,    _,    _,    _,'#22D3EE', _,   _,    _,    _,    _,    _,    _,    _ ],
      [ _,    _,    _,    _,    _,    _,'#06B6D4','#22D3EE','#06B6D4', _,   _,    _,    _,    _,    _,    _ ],
      [ _,    _,    _,    _,    _,'#1E293B','#1E293B','#1E293B','#1E293B','#1E293B', _,   _,    _,    _,    _,    _ ],
      [ _,    _,    _,    _,'#1E293B','#334155','#334155','#334155','#334155','#334155','#1E293B', _,   _,    _,    _,    _ ],
      [ _,    _,    _,'#1E293B','#334155','#06B6D4','#22D3EE','#334155','#06B6D4','#22D3EE','#334155','#1E293B', _,   _,    _,    _ ],
      [ _,    _,    _,'#1E293B','#334155','#22D3EE','#FFFFFF','#334155','#22D3EE','#FFFFFF','#334155','#1E293B', _,   _,    _,    _ ],
      [ _,    _,    _,'#1E293B','#334155','#334155','#334155','#334155','#334155','#334155','#334155','#1E293B', _,   _,    _,    _ ],
      [ _,    _,    _,    _,'#1E293B','#1E293B','#22D3EE','#22D3EE','#22D3EE','#1E293B','#1E293B', _,   _,    _,    _,    _ ],
      [ _,    _,    _,    _,    _,'#0F172A','#0F172A','#0F172A','#0F172A','#0F172A', _,   _,    _,    _,    _,    _ ],
      [ _,    _,    _,    _,'#0F172A','#0F172A','#1E293B','#1E293B','#1E293B','#0F172A','#0F172A', _,   _,    _,    _,    _ ],
      [ _,    _,    _,'#0F172A','#0F172A','#1E293B','#06B6D4','#06B6D4','#06B6D4','#1E293B','#0F172A','#0F172A', _,   _,    _,    _ ],
      ['#334155','#334155','#334155','#0F172A','#0F172A','#1E293B','#1E293B','#1E293B','#1E293B','#1E293B','#0F172A','#0F172A', _,   _,    _,    _ ],
      [ _,    _,    _,'#334155','#0F172A','#0F172A','#0F172A','#0F172A','#0F172A','#0F172A','#0F172A','#334155', _,   _,    _,    _ ],
      [ _,    _,    _,    _,'#334155','#334155','#0F172A','#0F172A','#0F172A','#334155','#334155', _,   _,    _,    _,    _ ],
      [ _,    _,    _,    _,'#334155','#334155', _,    _,    _,'#334155','#334155', _,   _,    _,    _,    _ ],
    ],
    // Frame 1
    [
      [ _,    _,    _,    _,    _,    _,    _,'#06B6D4', _,   _,    _,    _,    _,    _,    _,    _ ],
      [ _,    _,    _,    _,    _,    _,    _,'#22D3EE', _,   _,    _,    _,    _,    _,    _,    _ ],
      [ _,    _,    _,    _,    _,    _,'#06B6D4','#22D3EE','#06B6D4', _,   _,    _,    _,    _,    _,    _ ],
      [ _,    _,    _,    _,    _,'#1E293B','#1E293B','#1E293B','#1E293B','#1E293B', _,   _,    _,    _,    _,    _ ],
      [ _,    _,    _,    _,'#1E293B','#334155','#334155','#334155','#334155','#334155','#1E293B', _,   _,    _,    _,    _ ],
      [ _,    _,    _,'#1E293B','#334155','#06B6D4','#22D3EE','#334155','#06B6D4','#22D3EE','#334155','#1E293B', _,   _,    _,    _ ],
      [ _,    _,    _,'#1E293B','#334155','#22D3EE','#FFFFFF','#334155','#22D3EE','#FFFFFF','#334155','#1E293B', _,   _,    _,    _ ],
      [ _,    _,    _,'#1E293B','#334155','#334155','#334155','#334155','#334155','#334155','#334155','#1E293B', _,   _,    _,    _ ],
      [ _,    _,    _,    _,'#1E293B','#1E293B','#22D3EE','#22D3EE','#22D3EE','#1E293B','#1E293B', _,   _,    _,    _,    _ ],
      [ _,    _,    _,    _,    _,'#0F172A','#0F172A','#0F172A','#0F172A','#0F172A', _,   _,    _,    _,    _,    _ ],
      [ _,    _,    _,    _,'#0F172A','#0F172A','#1E293B','#1E293B','#1E293B','#0F172A','#0F172A', _,   _,    _,    _,    _ ],
      [ _,    _,    _,'#0F172A','#0F172A','#1E293B','#06B6D4','#06B6D4','#06B6D4','#1E293B','#0F172A','#0F172A', _,   _,    _,    _ ],
      [ _,    _,'#334155','#0F172A','#334155','#1E293B','#1E293B','#1E293B','#1E293B','#1E293B','#334155','#0F172A','#334155', _,   _,    _ ],
      [ _,    _,    _,'#334155','#0F172A','#0F172A','#0F172A','#0F172A','#0F172A','#0F172A','#0F172A','#334155', _,   _,    _,    _ ],
      [ _,    _,    _,    _,'#334155','#334155','#0F172A','#0F172A','#0F172A','#334155','#334155', _,   _,    _,    _,    _ ],
      [ _,    _,    _,    _,'#334155','#334155', _,    _,    _,'#334155','#334155', _,   _,    _,    _,    _ ],
    ],
    // Frame 2
    [
      [ _,    _,    _,    _,    _,    _,    _,'#06B6D4', _,   _,    _,    _,    _,    _,    _,    _ ],
      [ _,    _,    _,    _,    _,    _,    _,'#22D3EE', _,   _,    _,    _,    _,    _,    _,    _ ],
      [ _,    _,    _,    _,    _,    _,'#06B6D4','#22D3EE','#06B6D4', _,   _,    _,    _,    _,    _,    _ ],
      [ _,    _,    _,    _,    _,'#1E293B','#1E293B','#1E293B','#1E293B','#1E293B', _,   _,    _,    _,    _,    _ ],
      [ _,    _,    _,    _,'#1E293B','#334155','#334155','#334155','#334155','#334155','#1E293B', _,   _,    _,    _,    _ ],
      [ _,    _,    _,'#1E293B','#334155','#06B6D4','#22D3EE','#334155','#06B6D4','#22D3EE','#334155','#1E293B', _,   _,    _,    _ ],
      [ _,    _,    _,'#1E293B','#334155','#22D3EE','#FFFFFF','#334155','#22D3EE','#FFFFFF','#334155','#1E293B', _,   _,    _,    _ ],
      [ _,    _,    _,'#1E293B','#334155','#334155','#334155','#334155','#334155','#334155','#334155','#1E293B', _,   _,    _,    _ ],
      [ _,    _,    _,    _,'#1E293B','#1E293B','#22D3EE','#22D3EE','#22D3EE','#1E293B','#1E293B', _,   _,    _,    _,    _ ],
      [ _,    _,    _,    _,    _,'#0F172A','#0F172A','#0F172A','#0F172A','#0F172A', _,   _,    _,    _,    _,    _ ],
      [ _,    _,    _,    _,'#0F172A','#0F172A','#1E293B','#1E293B','#1E293B','#0F172A','#0F172A', _,   _,    _,    _,    _ ],
      [ _,    _,    _,'#0F172A','#0F172A','#1E293B','#06B6D4','#06B6D4','#06B6D4','#1E293B','#0F172A','#0F172A', _,   _,    _,    _ ],
      [ _,    _,    _,'#0F172A','#0F172A','#1E293B','#1E293B','#1E293B','#1E293B','#1E293B','#0F172A','#0F172A','#334155','#334155','#334155', _ ],
      [ _,    _,    _,'#334155','#0F172A','#0F172A','#0F172A','#0F172A','#0F172A','#0F172A','#0F172A','#334155', _,   _,    _,    _ ],
      [ _,    _,    _,    _,'#334155','#334155','#0F172A','#0F172A','#0F172A','#334155','#334155', _,   _,    _,    _,    _ ],
      [ _,    _,    _,    _,'#334155','#334155', _,    _,    _,'#334155','#334155', _,   _,    _,    _,    _ ],
    ],
  ],

  // ----------------------------------------------------------
  // AGENT_IDLE  (16x16) – agent avatar, blue-tinted
  // ----------------------------------------------------------
  AGENT_IDLE: [
    [ _,    _,    _,    _,    _,    _,    _,'#4A90D9', _,   _,    _,    _,    _,    _,    _,    _ ],
    [ _,    _,    _,    _,    _,    _,    _,'#4A90D9', _,   _,    _,    _,    _,    _,    _,    _ ],
    [ _,    _,    _,    _,    _,    _,'#6BB5FF','#4A90D9','#6BB5FF', _,   _,    _,    _,    _,    _,    _ ],
    [ _,    _,    _,    _,'#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A', _,   _,    _,    _,    _ ],
    [ _,    _,    _,'#4A4A4A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#4A4A4A', _,   _,    _,    _ ],
    [ _,    _,    _,'#4A4A4A','#5A5A5A','#4A90D9','#6BB5FF','#5A5A5A','#4A90D9','#6BB5FF','#5A5A5A','#4A4A4A', _,   _,    _,    _ ],
    [ _,    _,    _,'#4A4A4A','#5A5A5A','#6BB5FF','#FFFFFF','#5A5A5A','#6BB5FF','#FFFFFF','#5A5A5A','#4A4A4A', _,   _,    _,    _ ],
    [ _,    _,    _,'#4A4A4A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#4A4A4A', _,   _,    _,    _ ],
    [ _,    _,    _,    _,'#4A4A4A','#4A4A4A','#6BB5FF','#6BB5FF','#6BB5FF','#4A4A4A','#4A4A4A', _,   _,    _,    _,    _ ],
    [ _,    _,    _,    _,    _,'#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D', _,   _,    _,    _,    _,    _ ],
    [ _,    _,    _,    _,'#2D2D2D','#2D2D2D','#3A3A3A','#3A3A3A','#3A3A3A','#2D2D2D','#2D2D2D', _,   _,    _,    _,    _ ],
    [ _,    _,    _,'#2D2D2D','#2D2D2D','#3A3A3A','#4A90D9','#4A90D9','#4A90D9','#3A3A3A','#2D2D2D','#2D2D2D', _,   _,    _,    _ ],
    [ _,    _,'#4A4A4A','#2D2D2D','#2D2D2D','#3A3A3A','#3A3A3A','#3A3A3A','#3A3A3A','#3A3A3A','#2D2D2D','#2D2D2D','#4A4A4A', _,   _,    _ ],
    [ _,    _,    _,'#4A4A4A','#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D','#4A4A4A', _,   _,    _,    _ ],
    [ _,    _,    _,    _,'#4A4A4A','#4A4A4A','#2D2D2D','#2D2D2D','#2D2D2D','#4A4A4A','#4A4A4A', _,   _,    _,    _,    _ ],
    [ _,    _,    _,    _,'#4A4A4A','#4A4A4A', _,    _,    _,'#4A4A4A','#4A4A4A', _,   _,    _,    _,    _ ],
  ],

  // ----------------------------------------------------------
  // AGENT_WORKING  (16x16, 3 frames) – typing animation in blue
  // ----------------------------------------------------------
  AGENT_WORKING: [
    // Frame 0: hands left
    [
      [ _,    _,    _,    _,    _,    _,    _,'#4A90D9', _,   _,    _,    _,    _,    _,    _,    _ ],
      [ _,    _,    _,    _,    _,    _,    _,'#4A90D9', _,   _,    _,    _,    _,    _,    _,    _ ],
      [ _,    _,    _,    _,    _,    _,'#6BB5FF','#4A90D9','#6BB5FF', _,   _,    _,    _,    _,    _,    _ ],
      [ _,    _,    _,    _,'#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A', _,   _,    _,    _,    _ ],
      [ _,    _,    _,'#4A4A4A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#4A4A4A', _,   _,    _,    _ ],
      [ _,    _,    _,'#4A4A4A','#5A5A5A','#4A90D9','#6BB5FF','#5A5A5A','#4A90D9','#6BB5FF','#5A5A5A','#4A4A4A', _,   _,    _,    _ ],
      [ _,    _,    _,'#4A4A4A','#5A5A5A','#6BB5FF','#FFFFFF','#5A5A5A','#6BB5FF','#FFFFFF','#5A5A5A','#4A4A4A', _,   _,    _,    _ ],
      [ _,    _,    _,'#4A4A4A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#4A4A4A', _,   _,    _,    _ ],
      [ _,    _,    _,    _,'#4A4A4A','#4A4A4A','#6BB5FF','#6BB5FF','#6BB5FF','#4A4A4A','#4A4A4A', _,   _,    _,    _,    _ ],
      [ _,    _,    _,    _,    _,'#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D', _,   _,    _,    _,    _,    _ ],
      [ _,    _,    _,    _,'#2D2D2D','#2D2D2D','#3A3A3A','#3A3A3A','#3A3A3A','#2D2D2D','#2D2D2D', _,   _,    _,    _,    _ ],
      [ _,    _,    _,'#2D2D2D','#2D2D2D','#3A3A3A','#4A90D9','#4A90D9','#4A90D9','#3A3A3A','#2D2D2D','#2D2D2D', _,   _,    _,    _ ],
      ['#4A4A4A','#4A4A4A','#4A4A4A','#2D2D2D','#2D2D2D','#3A3A3A','#3A3A3A','#3A3A3A','#3A3A3A','#3A3A3A','#2D2D2D','#2D2D2D', _,   _,    _,    _ ],
      [ _,    _,    _,'#4A4A4A','#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D','#4A4A4A', _,   _,    _,    _ ],
      [ _,    _,    _,    _,'#4A4A4A','#4A4A4A','#2D2D2D','#2D2D2D','#2D2D2D','#4A4A4A','#4A4A4A', _,   _,    _,    _,    _ ],
      [ _,    _,    _,    _,'#4A4A4A','#4A4A4A', _,    _,    _,'#4A4A4A','#4A4A4A', _,   _,    _,    _,    _ ],
    ],
    // Frame 1: hands center
    [
      [ _,    _,    _,    _,    _,    _,    _,'#4A90D9', _,   _,    _,    _,    _,    _,    _,    _ ],
      [ _,    _,    _,    _,    _,    _,    _,'#4A90D9', _,   _,    _,    _,    _,    _,    _,    _ ],
      [ _,    _,    _,    _,    _,    _,'#6BB5FF','#4A90D9','#6BB5FF', _,   _,    _,    _,    _,    _,    _ ],
      [ _,    _,    _,    _,'#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A', _,   _,    _,    _,    _ ],
      [ _,    _,    _,'#4A4A4A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#4A4A4A', _,   _,    _,    _ ],
      [ _,    _,    _,'#4A4A4A','#5A5A5A','#4A90D9','#6BB5FF','#5A5A5A','#4A90D9','#6BB5FF','#5A5A5A','#4A4A4A', _,   _,    _,    _ ],
      [ _,    _,    _,'#4A4A4A','#5A5A5A','#6BB5FF','#FFFFFF','#5A5A5A','#6BB5FF','#FFFFFF','#5A5A5A','#4A4A4A', _,   _,    _,    _ ],
      [ _,    _,    _,'#4A4A4A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#4A4A4A', _,   _,    _,    _ ],
      [ _,    _,    _,    _,'#4A4A4A','#4A4A4A','#6BB5FF','#6BB5FF','#6BB5FF','#4A4A4A','#4A4A4A', _,   _,    _,    _,    _ ],
      [ _,    _,    _,    _,    _,'#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D', _,   _,    _,    _,    _,    _ ],
      [ _,    _,    _,    _,'#2D2D2D','#2D2D2D','#3A3A3A','#3A3A3A','#3A3A3A','#2D2D2D','#2D2D2D', _,   _,    _,    _,    _ ],
      [ _,    _,    _,'#2D2D2D','#2D2D2D','#3A3A3A','#4A90D9','#4A90D9','#4A90D9','#3A3A3A','#2D2D2D','#2D2D2D', _,   _,    _,    _ ],
      [ _,    _,'#4A4A4A','#2D2D2D','#4A4A4A','#3A3A3A','#3A3A3A','#3A3A3A','#3A3A3A','#3A3A3A','#4A4A4A','#2D2D2D','#4A4A4A', _,   _,    _ ],
      [ _,    _,    _,'#4A4A4A','#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D','#4A4A4A', _,   _,    _,    _ ],
      [ _,    _,    _,    _,'#4A4A4A','#4A4A4A','#2D2D2D','#2D2D2D','#2D2D2D','#4A4A4A','#4A4A4A', _,   _,    _,    _,    _ ],
      [ _,    _,    _,    _,'#4A4A4A','#4A4A4A', _,    _,    _,'#4A4A4A','#4A4A4A', _,   _,    _,    _,    _ ],
    ],
    // Frame 2: hands right
    [
      [ _,    _,    _,    _,    _,    _,    _,'#4A90D9', _,   _,    _,    _,    _,    _,    _,    _ ],
      [ _,    _,    _,    _,    _,    _,    _,'#4A90D9', _,   _,    _,    _,    _,    _,    _,    _ ],
      [ _,    _,    _,    _,    _,    _,'#6BB5FF','#4A90D9','#6BB5FF', _,   _,    _,    _,    _,    _,    _ ],
      [ _,    _,    _,    _,'#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A', _,   _,    _,    _,    _ ],
      [ _,    _,    _,'#4A4A4A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#4A4A4A', _,   _,    _,    _ ],
      [ _,    _,    _,'#4A4A4A','#5A5A5A','#4A90D9','#6BB5FF','#5A5A5A','#4A90D9','#6BB5FF','#5A5A5A','#4A4A4A', _,   _,    _,    _ ],
      [ _,    _,    _,'#4A4A4A','#5A5A5A','#6BB5FF','#FFFFFF','#5A5A5A','#6BB5FF','#FFFFFF','#5A5A5A','#4A4A4A', _,   _,    _,    _ ],
      [ _,    _,    _,'#4A4A4A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#5A5A5A','#4A4A4A', _,   _,    _,    _ ],
      [ _,    _,    _,    _,'#4A4A4A','#4A4A4A','#6BB5FF','#6BB5FF','#6BB5FF','#4A4A4A','#4A4A4A', _,   _,    _,    _,    _ ],
      [ _,    _,    _,    _,    _,'#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D', _,   _,    _,    _,    _,    _ ],
      [ _,    _,    _,    _,'#2D2D2D','#2D2D2D','#3A3A3A','#3A3A3A','#3A3A3A','#2D2D2D','#2D2D2D', _,   _,    _,    _,    _ ],
      [ _,    _,    _,'#2D2D2D','#2D2D2D','#3A3A3A','#4A90D9','#4A90D9','#4A90D9','#3A3A3A','#2D2D2D','#2D2D2D', _,   _,    _,    _ ],
      [ _,    _,    _,'#2D2D2D','#2D2D2D','#3A3A3A','#3A3A3A','#3A3A3A','#3A3A3A','#3A3A3A','#2D2D2D','#2D2D2D','#4A4A4A','#4A4A4A','#4A4A4A', _ ],
      [ _,    _,    _,'#4A4A4A','#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D','#2D2D2D','#4A4A4A', _,   _,    _,    _ ],
      [ _,    _,    _,    _,'#4A4A4A','#4A4A4A','#2D2D2D','#2D2D2D','#2D2D2D','#4A4A4A','#4A4A4A', _,   _,    _,    _,    _ ],
      [ _,    _,    _,    _,'#4A4A4A','#4A4A4A', _,    _,    _,'#4A4A4A','#4A4A4A', _,   _,    _,    _,    _ ],
    ],
  ],

  // ----------------------------------------------------------
  // DESK  (32x16) – pixel art office desk, brown wood tones
  // ----------------------------------------------------------
  DESK: [
    //0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31
    [ _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _ ],  // 0
    [ _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _ ],  // 1
    [ _,'#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914', _ ],  // 2  desk top edge
    ['#8B6914','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#8B6914'],  // 3  desk surface
    ['#8B6914','#B8943E','#A0782C','#B8943E','#A0782C','#B8943E','#A0782C','#B8943E','#A0782C','#B8943E','#A0782C','#B8943E','#A0782C','#B8943E','#A0782C','#B8943E','#A0782C','#B8943E','#A0782C','#B8943E','#A0782C','#B8943E','#A0782C','#B8943E','#A0782C','#B8943E','#A0782C','#B8943E','#A0782C','#B8943E','#A0782C','#8B6914'],  // 4  wood grain
    ['#8B6914','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#A0782C','#8B6914'],  // 5  desk surface
    ['#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914','#8B6914'],  // 6  front edge
    [ _,    _,'#8B6914','#8B6914', _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,'#8B6914','#8B6914', _,    _ ],  // 7  legs
    [ _,    _,'#8B6914','#8B6914', _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,'#8B6914','#8B6914', _,    _ ],  // 8
    [ _,    _,'#8B6914','#8B6914', _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,'#8B6914','#8B6914', _,    _ ],  // 9
    [ _,    _,'#8B6914','#8B6914', _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,'#8B6914','#8B6914', _,    _ ],  // 10
    [ _,    _,'#8B6914','#8B6914', _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,'#8B6914','#8B6914', _,    _ ],  // 11
    [ _,    _,'#8B6914','#8B6914', _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,'#8B6914','#8B6914', _,    _ ],  // 12
    [ _,    _,'#8B6914','#8B6914', _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,'#8B6914','#8B6914', _,    _ ],  // 13
    [ _,    _,'#8B6914','#8B6914', _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,'#8B6914','#8B6914', _,    _ ],  // 14
    [ _,    _,'#8B6914','#8B6914', _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,    _,'#8B6914','#8B6914', _,    _ ],  // 15
  ],

  // ----------------------------------------------------------
  // MONITOR  (12x12) – small CRT-style monitor with green screen
  // ----------------------------------------------------------
  MONITOR: [
    [ _,  '#333333','#333333','#333333','#333333','#333333','#333333','#333333','#333333','#333333','#333333', _ ],   // 0  top bezel
    ['#333333','#1A1A1A','#1A1A1A','#1A1A1A','#1A1A1A','#1A1A1A','#1A1A1A','#1A1A1A','#1A1A1A','#1A1A1A','#1A1A1A','#333333'],  // 1  inner bezel
    ['#333333','#1A1A1A','#003300','#003300','#003300','#003300','#003300','#003300','#003300','#003300','#1A1A1A','#333333'],  // 2  screen top
    ['#333333','#1A1A1A','#003300','#00FF41','#00FF41','#003300','#00FF41','#003300','#00FF41','#003300','#1A1A1A','#333333'],  // 3  screen text line 1
    ['#333333','#1A1A1A','#003300','#003300','#003300','#003300','#003300','#003300','#003300','#003300','#1A1A1A','#333333'],  // 4  screen gap
    ['#333333','#1A1A1A','#003300','#00FF41','#003300','#00FF41','#00FF41','#00FF41','#003300','#003300','#1A1A1A','#333333'],  // 5  screen text line 2
    ['#333333','#1A1A1A','#003300','#003300','#003300','#003300','#003300','#003300','#003300','#003300','#1A1A1A','#333333'],  // 6  screen gap
    ['#333333','#1A1A1A','#003300','#00FF41','#00FF41','#00FF41','#003300','#003300','#00FF41','#003300','#1A1A1A','#333333'],  // 7  screen text line 3
    ['#333333','#1A1A1A','#1A1A1A','#1A1A1A','#1A1A1A','#1A1A1A','#1A1A1A','#1A1A1A','#1A1A1A','#1A1A1A','#1A1A1A','#333333'],  // 8  inner bezel
    [ _,  '#333333','#333333','#333333','#333333','#333333','#333333','#333333','#333333','#333333','#333333', _ ],   // 9  bottom bezel
    [ _,    _,    _,    _,   '#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A', _,    _,    _,    _ ],   // 10 stand neck
    [ _,    _,    _,'#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A', _,    _,    _ ],   // 11 stand base
  ],

  // ----------------------------------------------------------
  // CHAIR  (12x16) – office swivel chair
  // ----------------------------------------------------------
  CHAIR: [
    [ _,    _,  '#333333','#333333','#333333','#333333','#333333','#333333','#333333','#333333', _,    _ ],   // 0  backrest top
    [ _,  '#333333','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#333333', _ ],   // 1
    [ _,  '#333333','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#333333', _ ],   // 2
    [ _,  '#333333','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#333333', _ ],   // 3
    [ _,  '#333333','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#333333', _ ],   // 4
    [ _,  '#333333','#333333','#333333','#333333','#333333','#333333','#333333','#333333','#333333','#333333', _ ],   // 5  backrest bottom edge
    [ _,    _,    _,    _,    _,'#1A1A1A','#1A1A1A', _,    _,    _,    _,    _ ],   // 6  gap between back and seat
    ['#1A1A1A','#333333','#333333','#333333','#333333','#333333','#333333','#333333','#333333','#333333','#333333','#1A1A1A'],  // 7  seat front edge
    ['#1A1A1A','#333333','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#333333','#1A1A1A'],  // 8  seat cushion
    ['#1A1A1A','#333333','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#4A4A4A','#333333','#1A1A1A'],  // 9
    [ _,  '#1A1A1A','#333333','#333333','#333333','#333333','#333333','#333333','#333333','#333333','#1A1A1A', _ ],   // 10 seat bottom
    [ _,    _,    _,    _,    _,'#1A1A1A','#1A1A1A', _,    _,    _,    _,    _ ],   // 11 piston
    [ _,    _,    _,    _,    _,'#1A1A1A','#1A1A1A', _,    _,    _,    _,    _ ],   // 12 piston
    [ _,    _,    _,    _,'#333333','#1A1A1A','#1A1A1A','#333333', _,    _,    _,    _ ],   // 13 base hub
    [ _,    _,'#333333','#333333', _,  '#333333','#333333', _,  '#333333','#333333', _,    _ ],   // 14 base wheels
    [ _,  '#1A1A1A','#1A1A1A', _,    _,    _,    _,    _,    _,'#1A1A1A','#1A1A1A', _ ],   // 15 wheel tips
  ],

  // ----------------------------------------------------------
  // PLANT  (8x12) – small desk plant in a pot
  // ----------------------------------------------------------
  PLANT: [
    [ _,    _,    _,'#4CAF50', _,    _,    _,    _ ],  // 0  leaf tip
    [ _,    _,'#4CAF50','#8BC34A','#4CAF50', _,    _,    _ ],  // 1  top leaves
    [ _,'#2D5A1E','#4CAF50','#8BC34A','#4CAF50','#8BC34A', _,    _ ],  // 2  more leaves
    ['#2D5A1E','#4CAF50','#8BC34A','#4CAF50','#8BC34A','#4CAF50','#2D5A1E', _ ],  // 3  full foliage
    [ _,'#4CAF50','#8BC34A','#4CAF50','#2D5A1E','#8BC34A','#4CAF50', _ ],  // 4  lower foliage
    [ _,    _,'#2D5A1E','#4CAF50','#4CAF50','#2D5A1E', _,    _ ],  // 5  inner leaves
    [ _,    _,    _,'#2D5A1E','#2D5A1E', _,    _,    _ ],  // 6  stem
    [ _,    _,    _,'#2D5A1E','#2D5A1E', _,    _,    _ ],  // 7  stem
    [ _,    _,'#795548','#795548','#795548','#795548', _,    _ ],  // 8  pot rim
    [ _,    _,'#795548','#8D6E63','#8D6E63','#795548', _,    _ ],  // 9  pot body
    [ _,    _,'#795548','#8D6E63','#8D6E63','#795548', _,    _ ],  // 10 pot body
    [ _,    _,    _,'#795548','#795548', _,    _,    _ ],  // 11 pot bottom
  ],

  // ----------------------------------------------------------
  // POOF  (16x16, 4 frames) – spawn/despawn puff animation
  // ----------------------------------------------------------
  POOF: [
    // Frame 0: small dot
    [
      [ _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _ ],
      [ _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _ ],
      [ _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _ ],
      [ _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _ ],
      [ _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _ ],
      [ _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _ ],
      [ _,  _,  _,  _,  _,  _,  _,'#FFFFFF','#FFFFFF', _,  _,  _,  _,  _,  _,  _ ],
      [ _,  _,  _,  _,  _,  _,'#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF', _,  _,  _,  _,  _,  _ ],
      [ _,  _,  _,  _,  _,  _,'#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF', _,  _,  _,  _,  _,  _ ],
      [ _,  _,  _,  _,  _,  _,  _,'#FFFFFF','#FFFFFF', _,  _,  _,  _,  _,  _,  _ ],
      [ _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _ ],
      [ _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _ ],
      [ _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _ ],
      [ _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _ ],
      [ _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _ ],
      [ _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _ ],
    ],
    // Frame 1: expanding cloud
    [
      [ _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _ ],
      [ _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _ ],
      [ _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _ ],
      [ _,  _,  _,  _,  _,'#CCCCCC', _,  _,  _,'#CCCCCC', _,  _,  _,  _,  _,  _ ],
      [ _,  _,  _,  _,'#CCCCCC','#FFFFFF','#FFFFFF', _,'#FFFFFF','#FFFFFF','#CCCCCC', _,  _,  _,  _,  _ ],
      [ _,  _,  _,'#CCCCCC','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#CCCCCC', _,  _,  _,  _ ],
      [ _,  _,  _,  _,'#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF', _,  _,  _,  _,  _ ],
      [ _,  _,  _,'#CCCCCC','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#CCCCCC', _,  _,  _,  _ ],
      [ _,  _,  _,'#CCCCCC','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#CCCCCC', _,  _,  _,  _ ],
      [ _,  _,  _,  _,'#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF', _,  _,  _,  _,  _ ],
      [ _,  _,  _,'#CCCCCC','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#CCCCCC', _,  _,  _,  _ ],
      [ _,  _,  _,  _,'#CCCCCC','#FFFFFF','#FFFFFF', _,'#FFFFFF','#FFFFFF','#CCCCCC', _,  _,  _,  _,  _ ],
      [ _,  _,  _,  _,  _,'#CCCCCC', _,  _,  _,'#CCCCCC', _,  _,  _,  _,  _,  _ ],
      [ _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _ ],
      [ _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _ ],
      [ _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _ ],
    ],
    // Frame 2: full cloud
    [
      [ _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _ ],
      [ _,  _,  _,  _,'#999999', _,  _,'#CCCCCC', _,  _,'#999999', _,  _,  _,  _,  _ ],
      [ _,  _,'#999999','#CCCCCC','#FFFFFF','#CCCCCC', _,'#CCCCCC','#FFFFFF','#CCCCCC','#FFFFFF','#999999', _,  _,  _,  _ ],
      [ _,'#999999','#CCCCCC','#FFFFFF','#FFFFFF','#FFFFFF','#CCCCCC','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#CCCCCC','#999999', _,  _,  _ ],
      ['#999999','#CCCCCC','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#CCCCCC','#999999', _,  _ ],
      [ _,'#CCCCCC','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#CCCCCC', _,  _,  _ ],
      ['#999999','#CCCCCC','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#CCCCCC','#999999', _,  _ ],
      [ _,'#CCCCCC','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#CCCCCC', _,  _,  _ ],
      [ _,'#CCCCCC','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#CCCCCC', _,  _,  _ ],
      ['#999999','#CCCCCC','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#CCCCCC','#999999', _,  _ ],
      [ _,'#CCCCCC','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#CCCCCC', _,  _,  _ ],
      ['#999999','#CCCCCC','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#CCCCCC','#999999', _,  _ ],
      [ _,'#999999','#CCCCCC','#FFFFFF','#FFFFFF','#FFFFFF','#CCCCCC','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#CCCCCC','#999999', _,  _,  _ ],
      [ _,  _,'#999999','#CCCCCC','#CCCCCC','#999999', _,'#999999','#CCCCCC','#CCCCCC','#999999', _,  _,  _,  _,  _ ],
      [ _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _ ],
      [ _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _ ],
    ],
    // Frame 3: fading cloud (dissipating)
    [
      [ _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _ ],
      [ _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _ ],
      [ _,  _,  _,'#999999', _,  _,  _,  _,  _,  _,'#999999', _,  _,  _,  _,  _ ],
      [ _,  _,  _,  _,'#CCCCCC', _,  _,  _,  _,'#CCCCCC', _,  _,  _,  _,  _,  _ ],
      [ _,'#999999', _,  _,  _,'#CCCCCC', _,  _,'#CCCCCC', _,  _,  _,'#999999', _,  _,  _ ],
      [ _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _ ],
      [ _,  _,'#CCCCCC', _,  _,  _,  _,  _,  _,  _,  _,  _,'#CCCCCC', _,  _,  _ ],
      [ _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _ ],
      [ _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _ ],
      [ _,  _,'#CCCCCC', _,  _,  _,  _,  _,  _,  _,  _,  _,'#CCCCCC', _,  _,  _ ],
      [ _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _ ],
      [ _,'#999999', _,  _,  _,'#CCCCCC', _,  _,'#CCCCCC', _,  _,  _,'#999999', _,  _,  _ ],
      [ _,  _,  _,  _,'#CCCCCC', _,  _,  _,  _,'#CCCCCC', _,  _,  _,  _,  _,  _ ],
      [ _,  _,  _,'#999999', _,  _,  _,  _,  _,  _,'#999999', _,  _,  _,  _,  _ ],
      [ _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _ ],
      [ _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _,  _ ],
    ],
  ],

  // ----------------------------------------------------------
  // COFFEE  (8x10) – coffee machine with red indicator light
  // ----------------------------------------------------------
  COFFEE: [
    [ _,  '#333333','#333333','#333333','#333333','#333333','#333333', _ ],   // 0  top
    ['#333333','#444444','#444444','#444444','#444444','#444444','#444444','#333333'],  // 1
    ['#333333','#444444','#FF0000','#444444','#444444','#555555','#444444','#333333'],  // 2  red light
    ['#333333','#444444','#444444','#444444','#444444','#444444','#444444','#333333'],  // 3
    ['#333333','#333333','#333333','#333333','#333333','#333333','#333333','#333333'],  // 4  divider
    ['#333333', _,    _,'#8B4513','#8B4513', _,    _,  '#333333'],  // 5  coffee stream
    ['#333333', _,  '#5C3317','#8B4513','#8B4513','#5C3317', _,  '#333333'],  // 6  cup
    ['#333333', _,  '#5C3317','#8B4513','#8B4513','#5C3317', _,  '#333333'],  // 7  cup
    ['#333333', _,  '#5C3317','#5C3317','#5C3317','#5C3317', _,  '#333333'],  // 8  cup bottom
    ['#333333','#333333','#333333','#333333','#333333','#333333','#333333','#333333'],  // 9  base
  ],
};


// ============================================================
// Drawing Functions
// ============================================================

/**
 * Draw a sprite on a canvas context at position (x, y) with optional scale.
 * @param {CanvasRenderingContext2D} ctx
 * @param {Array<Array<string|null>>} sprite - 2D array of hex colors (null = transparent)
 * @param {number} x - top-left x position
 * @param {number} y - top-left y position
 * @param {number} scale - pixel scale factor (default 1 = 1 pixel per cell)
 */
function drawSprite(ctx, sprite, x, y, scale = 1) {
  if (!sprite || !Array.isArray(sprite)) return;
  for (let row = 0; row < sprite.length; row++) {
    for (let col = 0; col < sprite[row].length; col++) {
      const color = sprite[row][col];
      if (color !== null && color !== undefined) {
        ctx.fillStyle = color;
        ctx.fillRect(
          Math.floor(x + col * scale),
          Math.floor(y + row * scale),
          Math.ceil(scale),
          Math.ceil(scale)
        );
      }
    }
  }
}

/**
 * Draw pixel-style text on canvas.
 * Uses a small built-in bitmap font (5x7 per character).
 * @param {CanvasRenderingContext2D} ctx
 * @param {string} text
 * @param {number} x
 * @param {number} y
 * @param {string} color - hex color string
 * @param {number} size - pixel scale for each font dot (default 1)
 */
function drawText(ctx, text, x, y, color = '#FFFFFF', size = 1) {
  // Minimal 5x7 bitmap font for common characters
  const FONT = {
    'A': [0x04,0x0A,0x11,0x1F,0x11,0x11,0x11],
    'B': [0x1E,0x11,0x11,0x1E,0x11,0x11,0x1E],
    'C': [0x0E,0x11,0x10,0x10,0x10,0x11,0x0E],
    'D': [0x1E,0x11,0x11,0x11,0x11,0x11,0x1E],
    'E': [0x1F,0x10,0x10,0x1E,0x10,0x10,0x1F],
    'F': [0x1F,0x10,0x10,0x1E,0x10,0x10,0x10],
    'G': [0x0E,0x11,0x10,0x17,0x11,0x11,0x0F],
    'H': [0x11,0x11,0x11,0x1F,0x11,0x11,0x11],
    'I': [0x0E,0x04,0x04,0x04,0x04,0x04,0x0E],
    'J': [0x07,0x02,0x02,0x02,0x02,0x12,0x0C],
    'K': [0x11,0x12,0x14,0x18,0x14,0x12,0x11],
    'L': [0x10,0x10,0x10,0x10,0x10,0x10,0x1F],
    'M': [0x11,0x1B,0x15,0x15,0x11,0x11,0x11],
    'N': [0x11,0x19,0x15,0x13,0x11,0x11,0x11],
    'O': [0x0E,0x11,0x11,0x11,0x11,0x11,0x0E],
    'P': [0x1E,0x11,0x11,0x1E,0x10,0x10,0x10],
    'Q': [0x0E,0x11,0x11,0x11,0x15,0x12,0x0D],
    'R': [0x1E,0x11,0x11,0x1E,0x14,0x12,0x11],
    'S': [0x0E,0x11,0x10,0x0E,0x01,0x11,0x0E],
    'T': [0x1F,0x04,0x04,0x04,0x04,0x04,0x04],
    'U': [0x11,0x11,0x11,0x11,0x11,0x11,0x0E],
    'V': [0x11,0x11,0x11,0x11,0x0A,0x0A,0x04],
    'W': [0x11,0x11,0x11,0x15,0x15,0x1B,0x11],
    'X': [0x11,0x11,0x0A,0x04,0x0A,0x11,0x11],
    'Y': [0x11,0x11,0x0A,0x04,0x04,0x04,0x04],
    'Z': [0x1F,0x01,0x02,0x04,0x08,0x10,0x1F],
    'a': [0x00,0x00,0x0E,0x01,0x0F,0x11,0x0F],
    'b': [0x10,0x10,0x1E,0x11,0x11,0x11,0x1E],
    'c': [0x00,0x00,0x0E,0x11,0x10,0x11,0x0E],
    'd': [0x01,0x01,0x0F,0x11,0x11,0x11,0x0F],
    'e': [0x00,0x00,0x0E,0x11,0x1F,0x10,0x0E],
    'f': [0x06,0x09,0x08,0x1C,0x08,0x08,0x08],
    'g': [0x00,0x00,0x0F,0x11,0x0F,0x01,0x0E],
    'h': [0x10,0x10,0x16,0x19,0x11,0x11,0x11],
    'i': [0x04,0x00,0x0C,0x04,0x04,0x04,0x0E],
    'j': [0x02,0x00,0x06,0x02,0x02,0x12,0x0C],
    'k': [0x10,0x10,0x12,0x14,0x18,0x14,0x12],
    'l': [0x0C,0x04,0x04,0x04,0x04,0x04,0x0E],
    'm': [0x00,0x00,0x1A,0x15,0x15,0x11,0x11],
    'n': [0x00,0x00,0x16,0x19,0x11,0x11,0x11],
    'o': [0x00,0x00,0x0E,0x11,0x11,0x11,0x0E],
    'p': [0x00,0x00,0x1E,0x11,0x1E,0x10,0x10],
    'q': [0x00,0x00,0x0F,0x11,0x0F,0x01,0x01],
    'r': [0x00,0x00,0x16,0x19,0x10,0x10,0x10],
    's': [0x00,0x00,0x0E,0x10,0x0E,0x01,0x1E],
    't': [0x08,0x08,0x1C,0x08,0x08,0x09,0x06],
    'u': [0x00,0x00,0x11,0x11,0x11,0x13,0x0D],
    'v': [0x00,0x00,0x11,0x11,0x11,0x0A,0x04],
    'w': [0x00,0x00,0x11,0x11,0x15,0x15,0x0A],
    'x': [0x00,0x00,0x11,0x0A,0x04,0x0A,0x11],
    'y': [0x00,0x00,0x11,0x11,0x0F,0x01,0x0E],
    'z': [0x00,0x00,0x1F,0x02,0x04,0x08,0x1F],
    '0': [0x0E,0x11,0x13,0x15,0x19,0x11,0x0E],
    '1': [0x04,0x0C,0x04,0x04,0x04,0x04,0x0E],
    '2': [0x0E,0x11,0x01,0x06,0x08,0x10,0x1F],
    '3': [0x0E,0x11,0x01,0x06,0x01,0x11,0x0E],
    '4': [0x02,0x06,0x0A,0x12,0x1F,0x02,0x02],
    '5': [0x1F,0x10,0x1E,0x01,0x01,0x11,0x0E],
    '6': [0x06,0x08,0x10,0x1E,0x11,0x11,0x0E],
    '7': [0x1F,0x01,0x02,0x04,0x08,0x08,0x08],
    '8': [0x0E,0x11,0x11,0x0E,0x11,0x11,0x0E],
    '9': [0x0E,0x11,0x11,0x0F,0x01,0x02,0x0C],
    ' ': [0x00,0x00,0x00,0x00,0x00,0x00,0x00],
    '.': [0x00,0x00,0x00,0x00,0x00,0x00,0x04],
    ',': [0x00,0x00,0x00,0x00,0x00,0x04,0x08],
    ':': [0x00,0x00,0x04,0x00,0x00,0x04,0x00],
    '!': [0x04,0x04,0x04,0x04,0x04,0x00,0x04],
    '?': [0x0E,0x11,0x01,0x02,0x04,0x00,0x04],
    '-': [0x00,0x00,0x00,0x1F,0x00,0x00,0x00],
    '_': [0x00,0x00,0x00,0x00,0x00,0x00,0x1F],
    '/': [0x01,0x01,0x02,0x04,0x08,0x10,0x10],
    '(': [0x02,0x04,0x08,0x08,0x08,0x04,0x02],
    ')': [0x08,0x04,0x02,0x02,0x02,0x04,0x08],
    '+': [0x00,0x04,0x04,0x1F,0x04,0x04,0x00],
    '=': [0x00,0x00,0x1F,0x00,0x1F,0x00,0x00],
    '#': [0x0A,0x0A,0x1F,0x0A,0x1F,0x0A,0x0A],
    '@': [0x0E,0x11,0x17,0x15,0x17,0x10,0x0E],
    "'": [0x04,0x04,0x08,0x00,0x00,0x00,0x00],
    '"': [0x0A,0x0A,0x14,0x00,0x00,0x00,0x00],
    '>': [0x08,0x04,0x02,0x01,0x02,0x04,0x08],
    '<': [0x02,0x04,0x08,0x10,0x08,0x04,0x02],
    '[': [0x0E,0x08,0x08,0x08,0x08,0x08,0x0E],
    ']': [0x0E,0x02,0x02,0x02,0x02,0x02,0x0E],
    '%': [0x19,0x19,0x02,0x04,0x08,0x13,0x13],
    '*': [0x00,0x04,0x15,0x0E,0x15,0x04,0x00],
  };

  ctx.fillStyle = color;
  const charWidth = 6 * size; // 5 pixels + 1 spacing

  for (let ci = 0; ci < text.length; ci++) {
    const ch = text[ci];
    const glyph = FONT[ch];
    if (!glyph) continue;

    for (let row = 0; row < 7; row++) {
      const bits = glyph[row];
      for (let bit = 0; bit < 5; bit++) {
        if (bits & (1 << (4 - bit))) {
          ctx.fillRect(
            Math.floor(x + ci * charWidth + bit * size),
            Math.floor(y + row * size),
            Math.ceil(size),
            Math.ceil(size)
          );
        }
      }
    }
  }
}

/**
 * Measure pixel text width (for wrapping calculations).
 * @param {string} text
 * @param {number} size
 * @returns {number} width in pixels
 */
function measureText(text, size = 1) {
  return text.length * 6 * size;
}

/**
 * Draw a pixel-art speech bubble with text.
 * Dark themed with accent stripe, status indicator, drop shadow, and float animation.
 * @param {CanvasRenderingContext2D} ctx
 * @param {string} text - the message to display
 * @param {number} x - center x of the bubble (above the avatar)
 * @param {number} y - bottom of the bubble (where the triangle pointer starts)
 * @param {number} maxWidth - max pixel width for the bubble (default 200)
 * @param {object} [options] - optional styling/animation overrides
 * @param {string} [options.accentColor='#FF6B00'] - color for the top accent stripe
 * @param {number} [options.animFrame=0] - animation frame for bobbing + status dots
 * @param {boolean} [options.isWorking=true] - true = animated dots, false = checkmark
 * @param {string} [options.bgColor='rgba(20, 20, 35, 0.92)'] - bubble background
 * @param {string} [options.textColor='#EEEEEE'] - text color
 */
function drawBubble(ctx, text, x, y, maxWidth = 200, options = {}) {
  const {
    accentColor = '#FF6B00',
    animFrame = 0,
    isWorking = true,
    bgColor = 'rgba(20, 20, 35, 0.92)',
    textColor = '#EEEEEE',
  } = options;

  const fontSize = 1;
  const lineH = 9 * fontSize;
  const padX = 6;
  const padY = 4;
  const pointerH = 5;
  const accentH = 3;          // accent stripe height
  const statusRowH = 9;       // space for the status indicator row
  const cornerR = 2;          // rounded corner cut depth

  // Floating bob: +/-2 px sine wave based on animFrame
  const bobOffset = Math.round(Math.sin(animFrame * 0.15) * 2);

  // Word-wrap text (with character-level breaking for long words)
  const innerW = maxWidth - padX * 2;
  const words = text.split(' ');
  const lines = [];
  let currentLine = '';

  for (const word of words) {
    const testLine = currentLine ? currentLine + ' ' + word : word;
    if (measureText(testLine, fontSize) <= innerW) {
      currentLine = testLine;
    } else {
      if (currentLine) lines.push(currentLine);
      // Break long words that exceed line width by themselves
      if (measureText(word, fontSize) > innerW) {
        let chunk = '';
        for (let ci = 0; ci < word.length; ci++) {
          const test = chunk + word[ci];
          if (measureText(test, fontSize) > innerW && chunk) {
            lines.push(chunk);
            chunk = word[ci];
          } else {
            chunk = test;
          }
        }
        currentLine = chunk;
      } else {
        currentLine = word;
      }
    }
  }
  if (currentLine) lines.push(currentLine);

  // Calculate bubble dimensions
  let bubbleW = 0;
  for (const line of lines) {
    const w = measureText(line, fontSize);
    if (w > bubbleW) bubbleW = w;
  }
  bubbleW += padX * 2;
  if (bubbleW < 30) bubbleW = 30;

  const textBlockH = lines.length * lineH + padY * 2;
  const bubbleH = accentH + textBlockH + statusRowH;
  const bubbleX = Math.floor(x - bubbleW / 2);
  const bubbleY = Math.floor(y - pointerH - bubbleH) + bobOffset;

  // Pointer X position (needed for knockout and pointer drawing)
  const pX = Math.floor(x);

  // --- Opaque knockout mask (prevents bleed-through from elements behind) ---
  ctx.fillStyle = '#000000';
  // Knockout for bubble body (same shape as body fills)
  ctx.fillRect(bubbleX + cornerR, bubbleY, bubbleW - cornerR * 2, bubbleH);
  ctx.fillRect(bubbleX, bubbleY + cornerR, bubbleW, bubbleH - cornerR * 2);
  ctx.fillRect(bubbleX + 1, bubbleY + 1, bubbleW - 2, bubbleH - 2);
  // Knockout for pointer triangle
  for (let ki = 0; ki < pointerH; ki++) {
    const kw = pointerH - ki;
    ctx.fillRect(pX - kw, bubbleY + bubbleH + ki, kw * 2, 1);
  }

  // --- Drop shadow (2px offset, dark translucent) ---
  ctx.fillStyle = 'rgba(0, 0, 0, 0.35)';
  ctx.fillRect(bubbleX + cornerR + 2, bubbleY + 2, bubbleW - cornerR * 2, bubbleH);
  ctx.fillRect(bubbleX + 2, bubbleY + cornerR + 2, bubbleW, bubbleH - cornerR * 2);
  ctx.fillRect(bubbleX + 1 + 2, bubbleY + 1 + 2, bubbleW - 2, bubbleH - 2);

  // --- Bubble body (dark background with 2px rounded corners) ---
  ctx.fillStyle = bgColor;
  // Main fills that leave 2px corner cuts
  ctx.fillRect(bubbleX + cornerR, bubbleY, bubbleW - cornerR * 2, bubbleH);
  ctx.fillRect(bubbleX, bubbleY + cornerR, bubbleW, bubbleH - cornerR * 2);
  // Fill in the 1px inner corner area (rounding: cut the outermost corner pixel)
  ctx.fillRect(bubbleX + 1, bubbleY + 1, bubbleW - 2, bubbleH - 2);

  // --- Border outline (1px, subtle light) ---
  ctx.fillStyle = 'rgba(255, 255, 255, 0.18)';
  // Top edge
  ctx.fillRect(bubbleX + cornerR, bubbleY, bubbleW - cornerR * 2, 1);
  // Bottom edge
  ctx.fillRect(bubbleX + cornerR, bubbleY + bubbleH - 1, bubbleW - cornerR * 2, 1);
  // Left edge
  ctx.fillRect(bubbleX, bubbleY + cornerR, 1, bubbleH - cornerR * 2);
  // Right edge
  ctx.fillRect(bubbleX + bubbleW - 1, bubbleY + cornerR, 1, bubbleH - cornerR * 2);
  // Corner single-pixel transitions (diagonal rounding)
  ctx.fillRect(bubbleX + 1, bubbleY + 1, 1, 1);
  ctx.fillRect(bubbleX + bubbleW - 2, bubbleY + 1, 1, 1);
  ctx.fillRect(bubbleX + 1, bubbleY + bubbleH - 2, 1, 1);
  ctx.fillRect(bubbleX + bubbleW - 2, bubbleY + bubbleH - 2, 1, 1);

  // --- Accent stripe at top ---
  ctx.fillStyle = accentColor;
  ctx.fillRect(bubbleX + cornerR, bubbleY + 1, bubbleW - cornerR * 2, accentH);
  ctx.fillRect(bubbleX + 1, bubbleY + 2, bubbleW - 2, accentH - 1);

  // --- Pointer triangle (dark, pointing down to avatar) ---
  ctx.fillStyle = bgColor;
  for (let i = 0; i < pointerH; i++) {
    const w = pointerH - i;
    ctx.fillRect(pX - w, bubbleY + bubbleH + i, w * 2, 1);
  }
  // Pointer border edges
  ctx.fillStyle = 'rgba(255, 255, 255, 0.18)';
  for (let i = 0; i < pointerH; i++) {
    const w = pointerH - i;
    ctx.fillRect(pX - w, bubbleY + bubbleH + i, 1, 1);
    ctx.fillRect(pX + w - 1, bubbleY + bubbleH + i, 1, 1);
  }
  ctx.fillRect(pX, bubbleY + bubbleH + pointerH - 1, 1, 1);

  // --- Draw text lines ---
  const textStartY = bubbleY + accentH + padY;
  for (let i = 0; i < lines.length; i++) {
    drawText(
      ctx,
      lines[i],
      bubbleX + padX,
      textStartY + i * lineH,
      textColor,
      fontSize
    );
  }

  // --- Status indicator row (below text) ---
  const statusY = textStartY + lines.length * lineH + 2;
  const statusX = bubbleX + padX;

  if (isWorking) {
    // Animated dots: 3 dots that cycle through brightness
    const dotSpacing = 4;
    const dotCount = 3;
    const cycle = Math.floor(animFrame * 0.2) % dotCount;
    for (let d = 0; d < dotCount; d++) {
      const bright = d === cycle ? 1.0 : 0.35;
      ctx.fillStyle = `rgba(255, 255, 255, ${bright})`;
      ctx.fillRect(statusX + d * dotSpacing, statusY + 2, 2, 2);
    }
  } else {
    // Checkmark: small pixel check in accent color
    ctx.fillStyle = accentColor;
    ctx.fillRect(statusX,     statusY + 4, 1, 1);
    ctx.fillRect(statusX + 1, statusY + 5, 1, 1);
    ctx.fillRect(statusX + 2, statusY + 4, 1, 1);
    ctx.fillRect(statusX + 3, statusY + 3, 1, 1);
    ctx.fillRect(statusX + 4, statusY + 2, 1, 1);
  }
}
